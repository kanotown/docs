{% extends "base.html" %} {% block header %} {{ super() }} {% endblock %} {%
block content %} {{ super() }} {% endblock %} {% block scripts %} {{ super() }}
{% endblock %} {% block footer %} {{ super() }}

<script>
  document.addEventListener("DOMContentLoaded", function () {
    var footerInner = document.querySelector(".md-footer-meta__inner.md-grid");
    if (footerInner) {
      var customElement = document.createElement("div");
      customElement.innerHTML = '<p id="auth-status">Not logged in</p>';
      footerInner.appendChild(customElement);
    }
  });
</script>
<script>
  async function setAuthStatus() {
    const token = localStorage.getItem("jwt");
    if (!token) return;
    const response = await fetch(
      "https://docs.kano-lab.com/auth/wp-json/protected/v1/resource",
      {
        headers: {
          Authorization: `Bearer ${token}`,
        },
      }
    );

    if (response.status === 200) {
      const data = await response.json();
      const status = document.getElementById("auth-status");
      status.innerHTML = "Logged in as " + data.email;
    } else {
      status.innerHTML = "Not logged in";
    }
  }
  setAuthStatus();
</script>
{% endblock %}
